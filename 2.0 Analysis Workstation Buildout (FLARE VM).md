## 2.1 Explain FLARE VM's purpose and what it is not (analysis toolkit, not a detonation lab)
- FLARE VM is a Windows analysis workstation build.
  - Designed for safe analysis.
- Primary intended uses.
  - File triage: hashes, metadata. You aren't doing malware analysis.
  - Artifact work: inspect and parse extracted logs, registry artifacts, and file system exports.
  - Controlled dynamic analysis when required, but not as the default.
- What it is not.
  - Not a detonation lab by default.
  - Not a sandbox replacement.
  - Not a safe place to casually run unknown binaries on a network.
- Operational goal.
  - Standardize tools and settings across analysts so outputs are consistent and defensible.

## 2.2 Validate FLARE VM prerequisites and baseline configuration (updates, PowerShell, reboots, AV exclusions as policy allows)
- Note: This is what I did to build the Flare VM, you don't need to do this.
- Start from a clean Windows VM build.
  - Allocate sufficient disk space for tools and case work (ingest and exports grow fast).
  - Allocate enough RAM to avoid paging during parsing and indexing.
- Patch and stabilize first.
  - Apply Windows updates before installing the FLARE toolset.
  - Reboot until updates are complete and the VM is stable.
- PowerShell readiness.
  - Use an elevated PowerShell session for installation and maintenance tasks.
  - Ensure execution policy and script controls comply with your environment rules.
- Snapshot hygiene.
  - Snapshot "baseline-clean" before installing tools.
  - Snapshot "baseline-flare" after installation, updates, and validation.
- Antivirus and exclusions (only if policy allows).
  - Expect AV to flag analysis tooling and scripts.
  - Prefer allowlisting tool directories rather than disabling protections broadly.
  - Never exclude evidence directories by default.

## 2.3 Implement a standard case folder structure on each workstation and on the central kit (cases, exports, logs, hashes, notes)

- Use the same structure everywhere to prevent mixing evidence, work output, and exports.
- This will need to be decided upon by the team.
- Recommended per-case layout.
  - `cases/<case_id>/evidence/` (original copies or mounted sources; no tool output)
  - `cases/<case_id>/work/` (ingest databases, parsed outputs, scratch space)
  - `cases/<case_id>/exports/` (final artifacts for reporting/handoff)
  - `cases/<case_id>/logs/` (tool logs, command logs, run context)
  - `cases/<case_id>/hashes/` (hash manifests for evidence and exports)
  - `cases/<case_id>/notes/` (timeline notes, assumptions, decisions)
- Naming standards.
  - Include case ID, host/user, artifact type, and date in filenames.
  - Avoid ambiguous names like `final.zip` or `new_output.csv`.

## 2.4 Apply safe handling practices for suspicious files (no execution, quarantine, controlled transfer to AMAC)

- Default posture: no execution of suspicious files.
  - Start with static analysis and contextual correlation.
- Quarantine extracted binaries and high-risk documents.
  - Store in a dedicated quarantine folder under the case.
  - Label clearly with hash prefix and source path.
- Avoid accidental execution paths.
  - Do not double-click samples.
  - Avoid previewing in applications that auto-run macros or embedded content.
  - Disable indexing in quarantine and evidence directories.
- Prepare for handoff with context.
  - Include hashes, original path, discovery method, and why it is suspicious.
  - Package using approved methods (password-protected archives if policy requires).
- Transfer only via approved workflow to AMAC.
  - No personal cloud, no ad-hoc USB swaps, no uncontrolled sharing.

## 2.5 Differentiate offline vs online analysis modes and configure safe switching (network profiles, proxy/VPN rules, isolation)

- Offline mode is the default.
  - Host-only networking or no adapter attached.
  - Best for most artifact work and sample triage.
- Online mode is exception-based, and requires permission. It's dangerous.
  - Used for updates, symbol retrieval, and approved lookups.
  - Use NAT rather than bridged networking.
- Safe switching procedure.
  - Snapshot before enabling network access.
  - Enable NAT, perform the task, then disable NAT.
  - Document the time window and purpose in case notes.
- Egress control principles.
  - Keep Windows network profile restrictive.
  - Avoid automatic network reconnection behaviors.
  - Never use bridged networking for routine analysis.
```