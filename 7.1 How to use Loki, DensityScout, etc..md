
*MUST BE USING A VMWARE WORKSTATION 17.5.x VERSION*

## 0) Pre-step: mount the evidence (Arsenal Image Mounter)
- Run Arsenal Image Mounter as admin.
- Mount mode: "Disk Device, Write Temporary" (keeps the image effectively read-only while allowing transient writes).
- Example mounted path used below: `F:\Mounted\Drive`

## 1) DensityScout (entropy hunting)
- Goal
  - Find high-entropy files (often packed/encrypted/compressed).
- Run (non-recursive, fastest first pass)
```cmd
cd /d "C:\Program Files\DensityScout"
DensityScout.exe -d "F:\Mounted\Drive" -o "C:\cases\CASE123\logs\DensityScout_results.txt"
````

- Run (recursive, broader scan)
    

```cmd
cd /d "C:\Program Files\DensityScout"
DensityScout.exe -d "F:\Mounted\Drive" -r -o "C:\cases\CASE123\logs\DensityScout_results_recursive.txt"
```

- What to do with output
    
    - Sort mentally by the highest entropy hits at the top.
        
    - Pull the top 10-20 file paths into the next steps (Sigcheck, then LOKI).
        

## 2) Sigcheck (signing and metadata triage)

- Goal
    
    - Identify unsigned or suspiciously signed binaries fast.
        
- Run (scan mounted drive; write to a results file)
    

```cmd
cd /d "C:\tools\sysinternals"
sigcheck64.exe -accepteula -h -q -r "F:\Mounted\Drive" > "C:\cases\CASE123\logs\sigcheck_results.txt"
```

- Run (append to an existing results file)
    

```cmd
cd /d "C:\tools\sysinternals"
sigcheck64.exe -accepteula -h -q -r "F:\Mounted\Drive" >> "C:\cases\CASE123\logs\sigcheck_results.txt"
```

- Run (single suspicious file from DensityScout/LOKI)
    

```cmd
cd /d "C:\tools\sysinternals"
sigcheck64.exe -accepteula -h -i -nobanner "F:\Mounted\Drive\path\to\suspicious.exe" > "C:\cases\CASE123\logs\sigcheck_singlefile.txt"
```

## 3) LOKI (YARA-driven scanning)

- Goal
    - Hunt for known-bad patterns and suspicious traits using rule matches.
    
- Run (standard scan of the mounted drive)

```cmd
cd /d "C:\tools\LOKI"
loki.exe -p "F:\Mounted\Drive" --logfile "C:\cases\CASE123\logs\loki_results.txt"
```

- Run (more aggressive scan when you have time or a narrowed target)

```cmd
cd /d "C:\tools\LOKI"
loki.exe -p "F:\Mounted\Drive" --intense --logfile "C:\cases\CASE123\logs\loki_results_intense.txt"
```

- Run (target only a suspicious directory, faster than full-drive)

```cmd
cd /d "C:\tools\LOKI"
loki.exe -p "F:\Mounted\Drive\Users" --logfile "C:\cases\CASE123\logs\loki_users_only.txt"
```

## 4) Hash anything you plan to report or hand off (SHA256)

- Hash a specific file (PowerShell)

```powershell
Get-FileHash -Algorithm SHA256 "F:\Mounted\Drive\path\to\suspicious.exe" | Format-List
```

- Hash a batch of exported files (PowerShell)

```powershell
Get-ChildItem "C:\cases\CASE123\exports" -Recurse -File |
  Get-FileHash -Algorithm SHA256 |
  Sort-Object Path |
  Out-File "C:\cases\CASE123\hashes\exports_sha256.txt"
```

## 5) Practical order of operations (fast to slow)

- Run DensityScout first to get a short list of packed/obfuscated candidates.
- Run Sigcheck next to quickly separate "normal signed vendor stuff" from "unsigned or weird".
- Run LOKI last to catch rule matches across the drive or the suspicious subtrees.
- Promote to "evidence" only when you can correlate:
    - tool hit + suspicious location + persistence/execution artifacts


Notes:
- I used common install paths (`C:\tools\...`) and a sample case path (`C:\cases\CASE123\...`). If your paths differ, keep the commands identical and only swap the directory strings.
- If you want, I can reformat these to match your exact folder layout and tool locations from your FLARE build (still keeping every command in its own copy-paste block).
